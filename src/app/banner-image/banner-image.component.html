<div *ngIf="isLoading" class="loader-container">
  <div class="loader"></div>
</div>

<div class="hei">
  <section class="sec1 w-100">
    <div class="header">
      <button type="button" class="btn btn-primary" (click)="openModal()">
        <i class="fas fa-plus"></i> Add New Slider
      </button>
    </div>

    <div *ngIf="!isLoading">
      <div class="admin-container">
        <div class="exam-table-container">
          <div class="exam-table-wrapper">
            <table class="exam-table table-bordered table-hover text-center align-middle">
              <thead class="table-dark">
                <tr>
                  <th>Sr.No</th>
                  <th>Banner Image</th>
                  <th>Action</th>
                </tr>
              </thead>
              <tbody>
                <tr *ngFor="let banner of allBanners; let i = index">
                  <th>{{ i + 1 }}</th>
                  <td class="center">
                    <img [src]="banner.slider_image_link"
                         [alt]="banner.slider_image_name"
                         class="img-thumbnail"
                         style="max-width: 120px; height: auto;" />
                  </td>
                  <td class="center">
                    <button class="btn btn-danger btn-sm" (click)="openDeleteModal(banner)">
                      <i class="fas fa-trash"></i> Delete
                    </button>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>

      <!-- Upload Banner Modal -->
      <div class="modal fade"
           tabindex="-1"
           [ngClass]="{ show: isModalOpen }"
           [ngStyle]="{ display: isModalOpen ? 'block' : 'none' }"
           aria-labelledby="exampleModalLabel"
           aria-hidden="!isModalOpen">
        <div class="modal-dialog modal-dialog-centered">
          <div class="modal-content">
            <div class="modal-header">
              <h5 class="modal-title" id="exampleModalLabel">
                Upload Banner Image
              </h5>
            </div>
            <div class="modal-body">
              <form (ngSubmit)="onSave()">
                <div class="form-group">
                  <input type="file"
                         id="bannerImage"
                         (change)="onImageSelected($event)"
                         class="form-control" />
                </div>
              </form>
            </div>
            <div class="modal-footer">
              <button type="button" class="btn btn-secondary" (click)="closeModal()">
                Cancel
              </button>
              <button type="button"
                      class="btn btn-primary"
                      [disabled]="isSubmitting"
                      (click)="onSave()">
                <span *ngIf="isSubmitting">Uploading...</span>
                <span *ngIf="!isSubmitting">Save</span>
              </button>
            </div>
          </div>
        </div>
      </div>

      <!-- Delete Banner Modal -->
      <div class="modal"
           *ngIf="deleteModal"
           tabindex="-1"
           [ngStyle]="{ display: deleteModal ? 'block' : 'none' }">
        <div class="modal-dialog modal-dialog-centered">
          <div class="modal-content">
            <div class="modal-header">
              <h3>Are you sure you want to delete this image?</h3>
              <button type="button" class="btn-close" (click)="closeDeleteModal()" aria-label="Close"></button>
            </div>
            <div class="modal-body">
              <img [src]="selectedBanner?.slider_image_link"
                   [alt]="selectedBanner?.slider_image_name"
                   class="modal-image" />
              <p>{{ selectedBanner?.slider_image_name }}</p>
            </div>
            <div class="modal-footer">
              <button class="btn btn-danger"
                      [disabled]="isDeleting"
                      (click)="deleteBannerImage(selectedBanner?.slider_image_id)">
                <span *ngIf="isDeleting">Deleting...</span>
                <span *ngIf="!isDeleting">Delete</span>
              </button>
              <button class="btn btn-secondary" (click)="closeDeleteModal()">
                Cancel
              </button>
            </div>
          </div>
        </div>
      </div>

    </div>
  </section>
</div>
