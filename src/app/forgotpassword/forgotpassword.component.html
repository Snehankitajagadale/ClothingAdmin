<div class="forgot-password-container">
  <!-- Step 1: Enter Email -->
  <div class="forgot-password-card" *ngIf="currentStep === 1">
    <h3 class="mb-4 forgot-password-title">Forgot Password</h3>
    <p class="mb-4 forgot-password-text">Enter your registered email address and we’ll send you instructions to reset your password.</p>
    <form [formGroup]="forgotPasswordForm" (ngSubmit)="onEmailSubmit()">
      <div class="input-container mb-3">
        <input type="email" formControlName="mailTo" placeholder="Email Address" class="form-control">
      </div>
      <button type="submit" class="btn btn-custom" [disabled]="!forgotPasswordForm.valid">Submit</button>
    </form>
  </div>

  <!-- Step 2: Enter OTP -->
  <div class="forgot-password-card" *ngIf="currentStep === 2">
    <h3 class="mb-4 otp-title">Enter OTP</h3>
    <p class="mb-4 otp-text">We’ve sent an OTP to your email address. Please enter it below to verify your account.</p>
    <form [formGroup]="otpForm" (ngSubmit)="onOtpSubmit()">
      <div class="input-container mb-3">
        <input type="number" formControlName="otp" placeholder="Enter OTP" class="form-control" maxlength="6">
      </div>
      <button type="submit" class="btn btn-custom" [disabled]="!otpForm.valid">Verify OTP</button>
    </form>
  </div>

  <!-- Step 3: Reset Password -->
  <div class="forgot-password-card" *ngIf="currentStep === 3">
    <h3 class="mb-4 reset-password-title">Set New Password</h3>
    <p class="mb-4 reset-password-text">Please set your new password and confirm it.</p>
    <form [formGroup]="passwordForm" (ngSubmit)="onPasswordSubmit()">
      
      <!-- Password Input with Eye Icon -->
      <div class="input-container mb-3 position-relative">
        <input 
          [type]="showPassword ? 'text' : 'password'"
          formControlName="password"
          placeholder="New Password"
          class="form-control"
          [ngClass]="{
            'is-invalid': passwordForm.get('password')?.invalid && passwordForm.get('password')?.touched
          }"
        />
        <i
          class="fa-solid toggle-password-icon"
          (click)="togglePasswordVisibility('password')"
          [class.fa-eye]="!showPassword"
          [class.fa-eye-slash]="showPassword"
        ></i>
        <div *ngIf="passwordForm.get('password')?.invalid && passwordForm.get('password')?.touched" class="invalid-feedback">
          <ng-container *ngIf="passwordForm.get('password')?.hasError('required')">
            Password is required.
          </ng-container>
          <ng-container *ngIf="passwordForm.get('password')?.hasError('minlength')">
            Password must be at least 6 characters long.
          </ng-container>
          <ng-container *ngIf="passwordForm.get('password')?.hasError('pattern')">
            Password must contain at least one uppercase letter, one lowercase letter, and one numeric digit.
          </ng-container>
        </div>
      </div>

      <!-- Confirm Password Input with Eye Icon -->
      <div class="input-container mb-3 position-relative">
        <input 
          [type]="showConfirmPassword ? 'text' : 'password'"
          formControlName="confirmPassword"
          placeholder="Confirm Password"
          class="form-control"
          [ngClass]="{
            'is-invalid': passwordForm.get('confirmPassword')?.invalid && passwordForm.get('confirmPassword')?.touched
          }"
        />
        <i
          class="fa-solid toggle-password-icon"
          (click)="togglePasswordVisibility('confirmPassword')"
          [class.fa-eye]="!showConfirmPassword"
          [class.fa-eye-slash]="showConfirmPassword"
        ></i>
        <div *ngIf="passwordForm.get('confirmPassword')?.errors?.['mismatch'] && passwordForm.get('confirmPassword')?.touched" class="invalid-feedback">
          Passwords do not match.
        </div>
      </div>

      <button type="submit" class="btn btn-custom">Reset Password</button>
    </form>
  </div>
</div>
